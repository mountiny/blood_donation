{% extends 'app/base.html' %}
{% load staticfiles %}

{% block menu_items_block %}

<li class="menu-item">
    <a class="menu-item__link h-link-effect" href="{% url 'app:login' %}">
        Profile
    </a> 
</li>
<li class="menu-item">
    <a class="menu-item__link h-link-effect" href="{% url 'app:logout' %}">
        Log out
    </a>
</li>
{% endblock %}

{% block body_block %}
<!-- <pre> {% filter force_escape %} {% debug %} {% endfilter %} </pre> -->

<div class="main-container">

    <div class="dasboard-container h-width">

        <h2 class="dashboard-heading h-900">Welcome back,{% if user.is_donor %} {{donor.nickname}} {% else %} {{hospital.name}} {% endif %}!</h1>

        <div class="dashboard-menu__container">
            <div class="dashboard-block h-border-radius h-shadow h-pointer show-map">
                <a href="{% url 'app:map'%}" class="dashboard-block__text">
                    
                    <span class="block-text__title h-900">Map</span><br />
                    Discover hospitals nearby!
                </a>
            </div>
            <div class="dashboard-block h-border-radius h-shadow h-pointer create-booking">
                <div class="dashboard-block__text">
                    <span class="block-text__title h-900">Book it</span><br />
                    Create an appointment at hospital you fancy!
                </div>
            </div>

        </div>

        <div class="stories-container">
            <h2 class="dashboard-heading h-900">Most popular stories</h2>
            <div class="stories-wrapper">
               
                    {% if stories %}
                        {% for story in stories %}

                        <div class="story-block">
                            <img src="{% static 'images/story_placeholder.jpg' %}" alt="Story picture" class="story-pic">
                            <div class="story-content">
                                <h4>{{ story.heading }}</h4>
                                <div class="story-text">Lorem ipsum dolor sit amet, consectetuer adipiscing elit. Vivamus ac leo pretium faucibus. Maecenas sollicitudin. Pellentesque arcu. Maecenas aliquet accumsan leo. Sed ut perspiciatis unde omnis iste natus error sit voluptatem accusantium doloremque laudantium, totam rem aperiam, eaque ipsa quae ab illo inventore veritatis et quasi architecto beatae vitae dicta sunt explicabo. Praesent id justo in neque elementum ultrices. Integer in sapien. Mauris dolor felis, sagittis at, luctus sed, aliquam non, tellus. Phasellus rhoncus. Nulla non lectus sed nisl molestie malesuada. Morbi leo mi, nonummy eget tristique non, rhoncus non leo. Etiam quis quam. Nunc auctor. Fusce dui leo, imperdiet in, aliquam sit amet, feugiat eu, orci. Pellentesque ipsum. Etiam posuere lacus quis dolor. Integer rutrum, orci vestibulum ullamcorper ultricies, lacus quam ultricies odio, vitae placerat pede sem sit amet enim. Pellentesque pretium lectus id turpis.</div>
                                <div class="story-block__bar">
                                    <a href="story?id={{ story.id }}" class="story-link h-700">Read the story</a>
                                    <div class="likes-cont h-pointer" data-id="{{ story.id }}">
                                        <svg class="icon_like" role="img" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" version="1.1" x="0" y="0" viewBox="0 0 128 128" enable-background="new 0 0 128 128" xml:space="preserve"><path id="heart" d="M64 127.5C17.1 79.9 3.9 62.3 1 44.4c-3.5-22 12.2-43.9 36.7-43.9 10.5 0 20 4.2 26.4 11.2 6.3-7 15.9-11.2 26.4-11.2 24.3 0 40.2 21.8 36.7 43.9C124.2 62 111.9 78.9 64 127.5zM37.6 13.4c-9.9 0-18.2 5.2-22.3 13.8C5 49.5 28.4 72 64 109.2c35.7-37.3 59-59.8 48.6-82 -4.1-8.7-12.4-13.8-22.3-13.8 -15.9 0-22.7 13-26.4 19.2C60.6 26.8 54.4 13.4 37.6 13.4z"></path>♥</svg>
                                        <span class="likes-count">{{ story.likes }}</span>
                                    </div>
                                </div>
                            </div>
                        </div>
                        
                        {% endfor %}
                    {% endif %}

                        <!-- <svg class="icon_like" role="img" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" version="1.1" x="0" y="0" viewBox="0 0 128 128" enable-background="new 0 0 128 128" xml:space="preserve"><path id="heart" d="M64 127.5C17.1 79.9 3.9 62.3 1 44.4c-3.5-22 12.2-43.9 36.7-43.9 10.5 0 20 4.2 26.4 11.2 6.3-7 15.9-11.2 26.4-11.2 24.3 0 40.2 21.8 36.7 43.9C124.2 62 111.9 78.9 64 127.5zM37.6 13.4c-9.9 0-18.2 5.2-22.3 13.8C5 49.5 28.4 72 64 109.2c35.7-37.3 59-59.8 48.6-82 -4.1-8.7-12.4-13.8-22.3-13.8 -15.9 0-22.7 13-26.4 19.2C60.6 26.8 54.4 13.4 37.6 13.4z"></path>♥</svg> -->
                
            </div>
        </div>

        <div class="bookings-container">
                <h2 class="dashboard-heading h-900">My bookings</h2>
                <div class="bookings-wrapper">
                   
                        {% if bookings %}
                            {% for booking in bookings %}
    
                            <div class="booking-block">
                                <div class="booking-content">
                                    <h4>{{ story.heading }}</h4>
                                    <div class="story-text">Lorem ipsum dolor sit amet, consectetuer adipiscing elit. Vivamus ac leo pretium faucibus. Maecenas sollicitudin. Pellentesque arcu. Maecenas aliquet accumsan leo. Sed ut perspiciatis unde omnis iste natus error sit voluptatem accusantium doloremque laudantium, totam rem aperiam, eaque ipsa quae ab illo inventore veritatis et quasi architecto beatae vitae dicta sunt explicabo. Praesent id justo in neque elementum ultrices. Integer in sapien. Mauris dolor felis, sagittis at, luctus sed, aliquam non, tellus. Phasellus rhoncus. Nulla non lectus sed nisl molestie malesuada. Morbi leo mi, nonummy eget tristique non, rhoncus non leo. Etiam quis quam. Nunc auctor. Fusce dui leo, imperdiet in, aliquam sit amet, feugiat eu, orci. Pellentesque ipsum. Etiam posuere lacus quis dolor. Integer rutrum, orci vestibulum ullamcorper ultricies, lacus quam ultricies odio, vitae placerat pede sem sit amet enim. Pellentesque pretium lectus id turpis.</div>
                                    <div class="story-block__bar">
                                        <a href="story?id={{ story.id }}" class="story-link h-700">Read the story</a>
                                        <div class="likes-cont h-pointer" data-id="{{ story.id }}">
                                            <svg class="icon_like" role="img" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" version="1.1" x="0" y="0" viewBox="0 0 128 128" enable-background="new 0 0 128 128" xml:space="preserve"><path id="heart" d="M64 127.5C17.1 79.9 3.9 62.3 1 44.4c-3.5-22 12.2-43.9 36.7-43.9 10.5 0 20 4.2 26.4 11.2 6.3-7 15.9-11.2 26.4-11.2 24.3 0 40.2 21.8 36.7 43.9C124.2 62 111.9 78.9 64 127.5zM37.6 13.4c-9.9 0-18.2 5.2-22.3 13.8C5 49.5 28.4 72 64 109.2c35.7-37.3 59-59.8 48.6-82 -4.1-8.7-12.4-13.8-22.3-13.8 -15.9 0-22.7 13-26.4 19.2C60.6 26.8 54.4 13.4 37.6 13.4z"></path>♥</svg>
                                            <span class="likes-count">{{ story.likes }}</span>
                                        </div>
                                    </div>
                                </div>
                            </div>
                            
                            {% endfor %}
                        {% else %}
                            <div class="booking-block">
                                
                                <!-- <div class="booking-content"> -->
                                    <div class="booking-date">22-05-2020</div>
                                    <div class="booking-hospital">Glasgow South Hospital</div>
                                    <div class="booking-actions">
                                        <div class="booking-delete h-pointer h-700" data-id="3">CANCEL</div>
                                    </div>
                                <!-- </div> -->
                            </div>
                            <div class="booking-block">
                                
                                <!-- <div class="booking-content"> -->
                                    <div class="booking-date">23-05-2020</div>
                                    <div class="booking-hospital">Glasgow North Hospital</div>
                                    <div class="booking-actions">
                                        <div class="booking-delete h-pointer h-700" data-id="4">CANCEL</div>
                                    </div>
                                <!-- </div> -->
                            </div>
                            <div class="booking-block">
                            
                                <!-- <div class="booking-content"> -->
                                    <div class="booking-date">24-05-2020</div>
                                    <div class="booking-hospital">Glasgow West Hospital</div>
                                    <div class="booking-actions">
                                        <div class="booking-delete h-pointer h-700" data-id="5">CANCEL</div>
                                    </div>
                                <!-- </div> -->
                            </div>
                        {% endif %}
    
                            <!-- <svg class="icon_like" role="img" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" version="1.1" x="0" y="0" viewBox="0 0 128 128" enable-background="new 0 0 128 128" xml:space="preserve"><path id="heart" d="M64 127.5C17.1 79.9 3.9 62.3 1 44.4c-3.5-22 12.2-43.9 36.7-43.9 10.5 0 20 4.2 26.4 11.2 6.3-7 15.9-11.2 26.4-11.2 24.3 0 40.2 21.8 36.7 43.9C124.2 62 111.9 78.9 64 127.5zM37.6 13.4c-9.9 0-18.2 5.2-22.3 13.8C5 49.5 28.4 72 64 109.2c35.7-37.3 59-59.8 48.6-82 -4.1-8.7-12.4-13.8-22.3-13.8 -15.9 0-22.7 13-26.4 19.2C60.6 26.8 54.4 13.4 37.6 13.4z"></path>♥</svg> -->
                    
                </div>
            </div>

            <div class="reviews-container">
                    <h2 class="dashboard-heading h-900">My reviews</h2>
                    <div class="reviews-wrapper">
                       
                            {% if reviews %}
                                {% for review in reviews %}
        
                                <div class="reviews-block">
                                    <!-- <img src="{% static 'images/story_placeholder.jpg' %}" alt="Story picture" class="story-pic">
                                    <div class="story-content">
                                        <h4>{{ review.heading }}</h4>
                                        <div class="story-text">Lorem ipsum dolor sit amet, consectetuer adipiscing elit. Vivamus ac leo pretium faucibus. Maecenas sollicitudin. Pellentesque arcu. Maecenas aliquet accumsan leo. Sed ut perspiciatis unde omnis iste natus error sit voluptatem accusantium doloremque laudantium, totam rem aperiam, eaque ipsa quae ab illo inventore veritatis et quasi architecto beatae vitae dicta sunt explicabo. Praesent id justo in neque elementum ultrices. Integer in sapien. Mauris dolor felis, sagittis at, luctus sed, aliquam non, tellus. Phasellus rhoncus. Nulla non lectus sed nisl molestie malesuada. Morbi leo mi, nonummy eget tristique non, rhoncus non leo. Etiam quis quam. Nunc auctor. Fusce dui leo, imperdiet in, aliquam sit amet, feugiat eu, orci. Pellentesque ipsum. Etiam posuere lacus quis dolor. Integer rutrum, orci vestibulum ullamcorper ultricies, lacus quam ultricies odio, vitae placerat pede sem sit amet enim. Pellentesque pretium lectus id turpis.</div>
                                        <div class="story-block__bar">
                                            <a href="story?id={{ story.id }}" class="story-link h-700">Read the story</a>
                                            <div class="likes-cont h-pointer" data-id="{{ story.id }}">
                                                <svg class="icon_like" role="img" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" version="1.1" x="0" y="0" viewBox="0 0 128 128" enable-background="new 0 0 128 128" xml:space="preserve"><path id="heart" d="M64 127.5C17.1 79.9 3.9 62.3 1 44.4c-3.5-22 12.2-43.9 36.7-43.9 10.5 0 20 4.2 26.4 11.2 6.3-7 15.9-11.2 26.4-11.2 24.3 0 40.2 21.8 36.7 43.9C124.2 62 111.9 78.9 64 127.5zM37.6 13.4c-9.9 0-18.2 5.2-22.3 13.8C5 49.5 28.4 72 64 109.2c35.7-37.3 59-59.8 48.6-82 -4.1-8.7-12.4-13.8-22.3-13.8 -15.9 0-22.7 13-26.4 19.2C60.6 26.8 54.4 13.4 37.6 13.4z"></path>♥</svg>
                                                <span class="likes-count">{{ story.likes }}</span>
                                            </div>
                                        </div>
                                    </div> -->
                                </div>
                                
                                {% endfor %}
                            {% else %}
                                <div class="reviews-block">
                                    <div class="reviews-content">
                                        <h4>You have not given any review yet</h4>

                                    </div>
                                </div>
                            {% endif %}
        
                                <!-- <svg class="icon_like" role="img" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" version="1.1" x="0" y="0" viewBox="0 0 128 128" enable-background="new 0 0 128 128" xml:space="preserve"><path id="heart" d="M64 127.5C17.1 79.9 3.9 62.3 1 44.4c-3.5-22 12.2-43.9 36.7-43.9 10.5 0 20 4.2 26.4 11.2 6.3-7 15.9-11.2 26.4-11.2 24.3 0 40.2 21.8 36.7 43.9C124.2 62 111.9 78.9 64 127.5zM37.6 13.4c-9.9 0-18.2 5.2-22.3 13.8C5 49.5 28.4 72 64 109.2c35.7-37.3 59-59.8 48.6-82 -4.1-8.7-12.4-13.8-22.3-13.8 -15.9 0-22.7 13-26.4 19.2C60.6 26.8 54.4 13.4 37.6 13.4z"></path>♥</svg> -->
                        
                    </div>
                </div>

    </div>
</div>

<div class="modal-wrapper" data-name="modal">
    <div class="modal-container">
        <div class="modal-content__msg h-700"></div>
        <div class="modal-buttons__cont">
                <div class="modal-button h-pointer h-uppercase modal-close h-link-effect-primary h-700">Close</div>
            <div class="modal-button h-pointer h-uppercase modal-btn-login h-link-effect-primary h-700"><a href="{% url 'app:login' %}">
                log in
            </a></div>
        </div>
    </div>
</div>
{% endblock %}


{% block javascript_block %}

<script>

$(document).ready(function() {

    // Get only 40 words of the story text
    function ellipsizeTextBox(e) {

        var wordArray = e.html().split(' ');
        var newArray = [];
        var i = 0;
        while(i < 40) {
            newArray.push(wordArray[i]);
            i++;
        }
        e.html(newArray.join(' ') + '...');
    }

    // Trim the text for all the texts
    $(".story-text").each(function() {
        ellipsizeTextBox($(this));
    })


})
</script>
{% endblock %}